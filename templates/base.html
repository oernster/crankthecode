<!DOCTYPE html>
<html>
<head>
  <title>{% block title %}CrankTheCode{% endblock %}</title>
  {% if meta_description %}
    <meta name="description" content="{{ meta_description }}">
  {% endif %}

  {% if canonical_url %}
    <link rel="canonical" href="{{ canonical_url }}">
  {% endif %}

  {# OpenGraph / Twitter (non-visual, improves previews) #}
  {% if og_title %}
    <meta property="og:title" content="{{ og_title }}">
  {% endif %}
  {% if meta_description %}
    <meta property="og:description" content="{{ meta_description }}">
  {% endif %}
  {% if canonical_url %}
    <meta property="og:url" content="{{ canonical_url }}">
  {% endif %}
  <meta property="og:type" content="{{ og_type or 'website' }}">
  <meta property="og:site_name" content="CrankTheCode">
  {% if og_image_url %}
    <meta property="og:image" content="{{ og_image_url }}">
  {% endif %}

  <meta name="twitter:card" content="summary_large_image">
  {% if og_title %}
    <meta name="twitter:title" content="{{ og_title }}">
  {% endif %}
  {% if meta_description %}
    <meta name="twitter:description" content="{{ meta_description }}">
  {% endif %}
  {% if og_image_url %}
    <meta name="twitter:image" content="{{ og_image_url }}">
  {% endif %}

  {% if robots_meta %}
    <meta name="robots" content="{{ robots_meta }}">
  {% endif %}

  {% if jsonld_json %}
    <script type="application/ld+json">{{ jsonld_json | safe }}</script>
  {% endif %}

  <link rel="stylesheet" href="/static/styles.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="alternate" type="application/rss+xml" title="CrankTheCode RSS" href="/rss.xml">
</head>
<body>
  <a class="skip-link" href="#main">Skip to content</a>

  <div class="header-layout{% if back_link_href %} header-layout--has-back{% endif %}">
    <div class="header-gutter header-email" aria-label="Email">
      <script type="text/javascript">
        // Slightly annoying but effective
        const user = "oernster";
        const domain = "codecrafter.uk";
        const link = `mailto:${user}@${domain}`;
        document.write(`<a class="header-email-link" href="${link}">${user}@${domain}</a>`);
      </script>
      <noscript>Email visible with JavaScript enabled ~ or reach me via GitHub.</noscript>
    </div>
    <div class="header-main">
      <div class="header-topbar" aria-label="Header actions">
        <div aria-hidden="true"></div>
        <div class="header-about-wrap">
          <a class="top-about-link" href="/about">About Me</a>
        </div>

        <div class="header-actions">
          <a class="home-favicon-link" href="/" aria-label="Home">
            <img class="home-favicon-icon" src="/favicon.ico" alt="" aria-hidden="true" />
          </a>
          <button
            class="icon-btn search-toggle"
            type="button"
            aria-label="Search"
            aria-expanded="false"
            aria-controls="search-panel"
          >
            üîç
          </button>
          <a class="rss-link" href="/rss.xml" aria-label="RSS feed">
            <img class="rss-icon" src="/static/rss.svg" alt="" />
          </a>
        </div>
      </div>

      <nav class="breadcrumbs" aria-label="Breadcrumb">
        {% for bc in breadcrumb_items or [] %}
          {% if loop.last %}
            <span class="breadcrumb-current" aria-current="page">{{ bc.label }}</span>
          {% else %}
            <a class="breadcrumb-link" href="{{ bc.href }}">{{ bc.label }}</a>
            <span class="breadcrumb-sep" aria-hidden="true">‚Ä∫</span>
          {% endif %}
        {% endfor %}
      </nav>

      <header class="site-header">
        {% if back_link_href %}
          <a class="back-link" href="{{ back_link_href }}">{{ back_link_label or "‚Üê Back" }}</a>
        {% else %}
          <div class="header-spacer" aria-hidden="true"></div>
        {% endif %}

        <a class="site-title-link" href="/" aria-label="Homepage">
          {% if is_homepage %}
            <h1 class="site-title">Crank The Code</h1>
          {% else %}
            <span class="site-title">Crank The Code</span>
          {% endif %}
        </a>

        <div class="header-spacer" aria-hidden="true"></div>
      </header>

      <div class="header-cta" aria-label="Contact call to action">
        <span class="header-cta-slot" aria-label="Email me">
          <script type="text/javascript">
            // Keep the email address out of the static HTML to reduce bot scraping.
            (function () {
              const user = "oernster";
              const domain = "codecrafter.uk";
              const link = `mailto:${user}@${domain}`;
              const label = "Let‚Äôs build something ~ email me.";
              document.currentScript.insertAdjacentHTML(
                "beforebegin",
                `<a class=\"header-cta-link\" href=\"${link}\">${label}</a>`
              );
            })();
          </script>
          <noscript>Let‚Äôs build something ~ email me. (Enable JavaScript to reveal the email link.)</noscript>
        </span>
      </div>

      <div id="search-panel" class="search-panel" hidden>
        <label class="visually-hidden" for="site-search">Search posts</label>
        <form class="search-form" role="search" action="/posts" method="get">
          <div class="search-input-wrap">
            <input
              id="site-search"
              class="search-input"
              name="q"
              type="search"
              placeholder="Search posts‚Ä¶"
              autocomplete="on"
              required
            />
            <div id="search-suggestions" class="search-suggestions" hidden></div>
            <button
              class="search-close"
              type="button"
              aria-label="Close search"
              title="Close search"
            >
              ‚úï
            </button>
          </div>
          <button class="search-go" type="submit" aria-label="Search">Go</button>
        </form>
      </div>
    </div>
  </div>

  <div class="page-layout">
    <nav class="sidebar" aria-label="Categories">
      <h2 class="sidebar-title">Categories</h2>
      <a
        class="sidebar-link{% if request.url.path == '/posts' and (current_q or '')|length == 0 %} is-active{% endif %}"
        href="/posts"
      >
        All Posts
      </a>
      {% for cat in sidebar_categories or [] %}
        <a
          class="sidebar-link{% if (current_q or '')|lower == (cat.query or '')|lower %} is-active{% endif %}"
          href="{{ cat.href }}"
        >
          {{ cat.label }}
        </a>
      {% endfor %}
    </nav>

    <main id="main" class="page-main">
      {% block content %}{% endblock %}
    </main>
  </div>

  <button
    id="scroll-top"
    class="scroll-top"
    type="button"
    aria-label="Scroll to top"
    title="Scroll to top"
    hidden
  >
    ‚¨ÜÔ∏è
  </button>

  <script src="/static/search.js" defer></script>
  <script src="/static/scroll-top.js" defer></script>
</body>
</html>

