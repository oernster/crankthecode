{% extends "base.html" %}

{% block title %}CrankTheCode â€” Posts{% endblock %}

{% block content %}
  <div class="posts-index" aria-label="All posts">
    {% for post in posts %}
      <div
        class="post-item"
        data-search="{{ (post.title ~ ' ' ~ (post.tags | join(' ')) ~ ' ' ~ (post.blurb or '') ~ ' ' ~ (post.one_liner or '') ~ ' ' ~ (post.summary_html | striptags)) | lower }}"
      >
        <div class="post-heading">
          <a class="btn-link btn-link--with-thumb" href="/posts/{{ post.slug }}">
            {% if post.cover_image_url %}
              <img class="btn-thumb" src="{{ post.cover_image_url }}" alt="" loading="lazy" />
            {% endif %}
            <span class="btn-text">
              {{ post.title }}
              {% if post.blurb %}
                <span class="btn-subtext">{{ post.blurb }}</span>
              {% endif %}
            </span>
          </a>
          <small>{{ post.date }} ~ Tags:
            {% for tag in post.tags %}
              <span class="tag">{{ tag }}</span>
            {% endfor %}
          </small>
          {% if post.one_liner or post.blurb %}
            <div class="post-one-liner">{{ post.one_liner or post.blurb }}</div>
          {% endif %}
        </div>
        {% if post.cover_image_url %}
          <a class="post-cover-link" href="/posts/{{ post.slug }}" aria-label="Open {{ post.title }}">
            <img class="post-cover" src="{{ post.cover_image_url }}" alt="" loading="lazy" />
          </a>
        {% endif %}
        <div class="post-summary">{{ post.summary_html | safe }}</div>
      </div>
      {% if not loop.last %}
        <hr class="post-separator" />
      {% endif %}
    {% endfor %}
  </div>
{% endblock %}
