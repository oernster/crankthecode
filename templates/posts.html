{% extends "base.html" %}

{% block title %}Posts | Crank The Code{% endblock %}

{% block content %}
  <div class="posts-index" aria-label="All posts">
    {% for post in posts %}
      <div
        class="post-item"
        data-search="{{ (post.title ~ ' ' ~ (post.tags | join(' '))) | lower }}"
      >
        <div class="post-heading">
          <a class="btn-link btn-link--with-thumb" href="/posts/{{ post.slug }}">
            {% set thumb = post.thumb_image_url or post.cover_image_url %}
            {% if (post.emoji or '')|length > 0 %}
              <span class="btn-thumb btn-thumb--emoji" aria-hidden="true">{{ post.emoji }}</span>
            {% elif post.slug == 'calendifier' %}
              <span class="btn-thumb btn-thumb--emoji" aria-hidden="true">ðŸ“…</span>
            {% elif post.slug == 'elevator' %}
              <span class="btn-thumb btn-thumb--emoji" aria-hidden="true">ðŸ›—</span>
            {% elif post.slug == 'audiodeck' %}
              <span class="btn-thumb btn-thumb--emoji" aria-hidden="true">ðŸ”Š</span>
            {% elif post.slug == 'galacticunicorn' %}
              <span class="btn-thumb btn-thumb--emoji" aria-hidden="true">ðŸ¦„</span>
            {% elif post.slug == '3D-printer-launcher' %}
              <img class="btn-thumb" src="/static/images/3dprinterlauncher-icon.png" alt="{{ post.title }}" loading="lazy" />
            {% elif post.slug == 'fancy-clock' %}
              <img class="btn-thumb" src="/static/images/fancyclock-icon.png" alt="{{ post.title }}" loading="lazy" />
            {% elif thumb %}
              <img class="btn-thumb" src="{{ thumb }}" alt="{{ post.title }}" loading="lazy" />
            {% endif %}
            <span class="btn-text">
              {{ post.title_text or post.title }}
              {% if post.blurb %}
                <span class="btn-subtext">{{ post.blurb }}</span>
              {% endif %}
            </span>
          </a>
          <div class="post-meta">
            <small class="post-date">{{ post.date }}</small>
            <small class="post-tags">
              Tags:
              {% for tag in post.tags %}
                <span class="tag">{{ tag }}</span>
              {% endfor %}
            </small>
          </div>
          {% if post.one_liner or post.blurb %}
            <div class="post-one-liner">{{ post.one_liner or post.blurb }}</div>
          {% endif %}
        </div>
        {% if post.cover_image_url %}
          <a class="post-cover-link" href="/posts/{{ post.slug }}" aria-label="Open {{ post.title }}">
            <img class="post-cover" src="{{ post.cover_image_url }}" alt="{{ post.title }}" loading="lazy" />
          </a>
        {% endif %}
        <div class="post-summary">{{ post.summary_html | safe }}</div>
      </div>
      {% if not loop.last %}
        <hr class="post-separator" />
      {% endif %}
    {% endfor %}
  </div>
{% endblock %}
